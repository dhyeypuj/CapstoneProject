<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fraud Detection Platform</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 20px; }
        h1 { color: #333; }
        .card { background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 8px; margin: 5px 0; box-sizing: border-box; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        #result { margin-top: 15px; font-size: 1.2em; font-weight: bold; }
        .fraud { color: red; }
        .legit { color: green; }
    </style>
</head>
<body>
    <h1>üîç Fraud Detection Platform</h1>

    <div class="card">
        <h2>Live Prediction</h2>
        <p>Paste 30 comma-separated feature values from your dataset:</p>
        <input type="text" id="features" placeholder="0.1, 0.2, -1.3, ... (30 values)">
        <button onclick="predict()">Check Transaction</button>
        <div id="result"></div>
    </div>

    <div class="card">
        <h2>Recent Predictions</h2>
        <div id="history">Loading...</div>
    </div>

    <script>
        async function predict() {
            const raw = document.getElementById('features').value;
            const features = raw.split(',').map(Number);
            
            if (features.length !== 30) {
                document.getElementById('result').innerHTML = 'Please enter exactly 30 values.';
                return;
            }

            const res = await fetch('/predict', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ features })
            });

            const data = await res.json();
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `Result: <span class="${data.is_fraud ? 'fraud' : 'legit'}">${data.label}</span> (Probability: ${data.fraud_probability})`;
            loadHistory();
        }

        async function loadHistory() {
            const res = await fetch('/history');
            const data = await res.json();
            const div = document.getElementById('history');
            if (data.length === 0) {
                div.innerHTML = 'No predictions yet.';
                return;
            }
            div.innerHTML = data.map(d => `
                <p>${d.timestamp} ‚Äî <span class="${d.is_fraud ? 'fraud' : 'legit'}">${d.is_fraud ? 'FRAUD' : 'LEGITIMATE'}</span> (${d.fraud_probability})</p>
            `).join('');
        }

        loadHistory();
    </script>
</body>
</html>